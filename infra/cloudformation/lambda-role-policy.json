{
  "description": "IAM policy examples for Lambda execution role in RAG application",
  "policies": {
    "BedrockModelInvoke": {
      "Effect": "Allow",
      "Action": [
        "bedrock:InvokeModel",
        "bedrock:InvokeModelWithResponseStream"
      ],
      "Resource": "arn:aws:bedrock:us-east-1::foundation-model/anthropic.claude-3-5-sonnet-20240620-v1:0",
      "comment": "Replace us-east-1 and model ID with your actual region and model"
    },
    "BedrockKnowledgeBaseRetrieve": {
      "Effect": "Allow",
      "Action": [
        "bedrock-agent-runtime:Retrieve"
      ],
      "Resource": "*",
      "comment": "TODO: Scope down to specific Knowledge Base ARN when available. Format: arn:aws:bedrock:<region>:<account-id>:knowledge-base/<kb-id>"
    },
    "SecretsManagerAccess": {
      "Effect": "Allow",
      "Action": [
        "secretsmanager:GetSecretValue"
      ],
      "Resource": "arn:aws:secretsmanager:*:*:secret:rag-app-*-db-credentials-*",
      "comment": "Replace with your actual secret ARN pattern"
    },
    "CloudWatchLogs": {
      "Effect": "Allow",
      "Action": [
        "logs:CreateLogGroup",
        "logs:CreateLogStream",
        "logs:PutLogEvents"
      ],
      "Resource": "arn:aws:logs:*:*:log-group:/aws/lambda/rag-app-*",
      "comment": "Replace with your actual log group ARN pattern"
    },
    "VPCAccess": {
      "Effect": "Allow",
      "Action": [
        "ec2:CreateNetworkInterface",
        "ec2:DescribeNetworkInterfaces",
        "ec2:DeleteNetworkInterface",
        "ec2:AssignPrivateIpAddresses",
        "ec2:UnassignPrivateIpAddresses"
      ],
      "Resource": "*",
      "comment": "Required for Lambda to create ENIs in VPC. Consider scoping to specific VPC/subnets if possible."
    }
  },
  "notes": [
    "These policies are provided as reference examples.",
    "The CloudFormation template (lambda-function.yaml) automatically creates these policies with proper scoping.",
    "For production, always scope down Resource ARNs to the minimum required.",
    "The Bedrock Knowledge Base Retrieve action may need to be scoped to the specific KB ARN after KB creation."
  ]
}

