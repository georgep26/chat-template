<mxfile host="app.diagrams.net" modified="2026-01-07T00:00:00.000Z" agent="draw.io" version="22.1.16" etag="rag-chat-architecture" type="device">
  <diagram id="rag-chat-architecture" name="RAG Chat Application Architecture">
    <mxGraphModel dx="1800" dy="1000" grid="0" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="3300" pageHeight="2339" background="#ffffff" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        
        <!-- Title -->
        <mxCell id="title" value="RAG Chat Application Architecture" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=28;fontStyle=1" parent="1" vertex="1">
          <mxGeometry x="1100" y="30" width="600" height="50" as="geometry" />
        </mxCell>
        
        <!-- Logical Paths Textbox -->
        <mxCell id="logical-paths-title" value="Logical Paths" style="text;html=1;strokeColor=#000000;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=16;fontStyle=1" parent="1" vertex="1">
          <mxGeometry x="100" y="100" width="380" height="30" as="geometry" />
        </mxCell>
        
        <mxCell id="logical-paths-content" value="&lt;div style=&quot;padding:10px;&quot;&gt;&lt;b style=&quot;font-size:15px;&quot;&gt;1. User Query Flow (Red):&lt;/b&gt;&lt;br&gt;&lt;br&gt;&lt;div style=&quot;margin-bottom:8px;display:flex;align-items:flex-start;&quot;&gt;&lt;span style=&quot;display:inline-block;width:24px;height:24px;line-height:24px;text-align:center;border-radius:50%;background-color:#FF6B6B;color:#FFFFFF;font-weight:bold;margin-right:8px;flex-shrink:0;&quot;&gt;1&lt;/span&gt;&lt;div style=&quot;flex:1;&quot;&gt;User sends chat request to Lambda&lt;/div&gt;&lt;/div&gt;&lt;div style=&quot;margin-bottom:8px;display:flex;align-items:flex-start;&quot;&gt;&lt;span style=&quot;display:inline-block;width:24px;height:24px;line-height:24px;text-align:center;border-radius:50%;background-color:#FF6B6B;color:#FFFFFF;font-weight:bold;margin-right:8px;flex-shrink:0;&quot;&gt;2&lt;/span&gt;&lt;div style=&quot;flex:1;&quot;&gt;Lambda retrieves context from Knowledge Base&lt;/div&gt;&lt;/div&gt;&lt;div style=&quot;margin-bottom:8px;display:flex;align-items:flex-start;&quot;&gt;&lt;span style=&quot;display:inline-block;width:24px;height:24px;line-height:24px;text-align:center;border-radius:50%;background-color:#FF6B6B;color:#FFFFFF;font-weight:bold;margin-right:8px;flex-shrink:0;&quot;&gt;3&lt;/span&gt;&lt;div style=&quot;flex:1;&quot;&gt;Knowledge Base searches Aurora pgvector&lt;/div&gt;&lt;/div&gt;&lt;div style=&quot;margin-bottom:8px;display:flex;align-items:flex-start;&quot;&gt;&lt;span style=&quot;display:inline-block;width:24px;height:24px;line-height:24px;text-align:center;border-radius:50%;background-color:#FF6B6B;color:#FFFFFF;font-weight:bold;margin-right:8px;flex-shrink:0;&quot;&gt;4&lt;/span&gt;&lt;div style=&quot;flex:1;&quot;&gt;Bedrock generates response with context&lt;/div&gt;&lt;/div&gt;&lt;div style=&quot;margin-bottom:8px;display:flex;align-items:flex-start;&quot;&gt;&lt;span style=&quot;display:inline-block;width:24px;height:24px;line-height:24px;text-align:center;border-radius:50%;background-color:#FF6B6B;color:#FFFFFF;font-weight:bold;margin-right:8px;flex-shrink:0;&quot;&gt;5&lt;/span&gt;&lt;div style=&quot;flex:1;&quot;&gt;Lambda stores chat history in Aurora&lt;/div&gt;&lt;/div&gt;&lt;br&gt;&lt;b style=&quot;font-size:15px;&quot;&gt;2. Document Ingestion (Blue):&lt;/b&gt;&lt;br&gt;&lt;br&gt;&lt;div style=&quot;margin-bottom:8px;display:flex;align-items:flex-start;&quot;&gt;&lt;span style=&quot;display:inline-block;width:24px;height:24px;line-height:24px;text-align:center;border-radius:50%;background-color:#4A90E2;color:#FFFFFF;font-weight:bold;margin-right:8px;flex-shrink:0;&quot;&gt;1&lt;/span&gt;&lt;div style=&quot;flex:1;&quot;&gt;Documents uploaded to S3 bucket&lt;/div&gt;&lt;/div&gt;&lt;div style=&quot;margin-bottom:8px;display:flex;align-items:flex-start;&quot;&gt;&lt;span style=&quot;display:inline-block;width:24px;height:24px;line-height:24px;text-align:center;border-radius:50%;background-color:#4A90E2;color:#FFFFFF;font-weight:bold;margin-right:8px;flex-shrink:0;&quot;&gt;2&lt;/span&gt;&lt;div style=&quot;flex:1;&quot;&gt;Knowledge Base syncs and processes docs&lt;/div&gt;&lt;/div&gt;&lt;div style=&quot;margin-bottom:8px;display:flex;align-items:flex-start;&quot;&gt;&lt;span style=&quot;display:inline-block;width:24px;height:24px;line-height:24px;text-align:center;border-radius:50%;background-color:#4A90E2;color:#FFFFFF;font-weight:bold;margin-right:8px;flex-shrink:0;&quot;&gt;3&lt;/span&gt;&lt;div style=&quot;flex:1;&quot;&gt;Embeddings stored in Aurora pgvector&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;" style="text;html=1;strokeColor=#000000;fillColor=#F5F5F5;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=12;fontStyle=0" parent="1" vertex="1">
          <mxGeometry x="100" y="130" width="380" height="450" as="geometry" />
        </mxCell>
        
        <!-- AWS Cloud Container -->
        <mxCell id="aws-cloud" value="AWS Cloud" style="points=[[0,0],[0.25,0],[0.5,0],[0.75,0],[1,0],[1,0.25],[1,0.5],[1,0.75],[1,1],[0.75,1],[0.5,1],[0.25,1],[0,1],[0,0.75],[0,0.5],[0,0.25]];outlineConnect=0;gradientColor=none;html=1;whiteSpace=wrap;fontSize=12;fontStyle=0;container=1;pointerEvents=0;collapsible=0;recursiveResize=0;shape=mxgraph.aws4.group;grIcon=mxgraph.aws4.group_aws_cloud_alt;strokeColor=#232F3E;fillColor=none;verticalAlign=top;align=left;spacingLeft=30;fontColor=#232F3E;dashed=0;" parent="1" vertex="1">
          <mxGeometry x="520" y="100" width="2600" height="2100" as="geometry" />
        </mxCell>
        
        <!-- User (outside VPC) -->
        <mxCell id="user" value="Users" style="sketch=0;outlineConnect=0;fontColor=#232F3E;gradientColor=none;fillColor=#232F3D;strokeColor=none;dashed=0;verticalLabelPosition=bottom;verticalAlign=top;align=center;html=1;fontSize=12;fontStyle=0;aspect=fixed;pointerEvents=1;shape=mxgraph.aws4.user;" parent="aws-cloud" vertex="1">
          <mxGeometry x="80" y="250" width="60" height="60" as="geometry" />
        </mxCell>
        
        <!-- User Query Flow Badge 1 -->
        <mxCell id="badge-user-1" value="1" style="ellipse;whiteSpace=wrap;html=1;fillColor=#FF6B6B;strokeColor=#FFFFFF;fontColor=#FFFFFF;fontSize=14;fontStyle=1" parent="aws-cloud" vertex="1">
          <mxGeometry x="70" y="240" width="24" height="24" as="geometry" />
        </mxCell>
        
        <!-- VPC Container -->
        <mxCell id="vpc" value="VPC (10.0.0.0/16)" style="points=[[0,0],[0.25,0],[0.5,0],[0.75,0],[1,0],[1,0.25],[1,0.5],[1,0.75],[1,1],[0.75,1],[0.5,1],[0.25,1],[0,1],[0,0.75],[0,0.5],[0,0.25]];outlineConnect=0;gradientColor=none;html=1;whiteSpace=wrap;fontSize=12;fontStyle=0;container=1;pointerEvents=0;collapsible=0;recursiveResize=0;shape=mxgraph.aws4.group;grIcon=mxgraph.aws4.group_vpc2;strokeColor=#8C4FFF;fillColor=none;verticalAlign=top;align=left;spacingLeft=30;fontColor=#AAB7B8;dashed=0;" parent="aws-cloud" vertex="1">
          <mxGeometry x="200" y="150" width="1400" height="900" as="geometry" />
        </mxCell>
        
        <!-- Public Subnet -->
        <mxCell id="public-subnet" value="Public Subnet" style="points=[[0,0],[0.25,0],[0.5,0],[0.75,0],[1,0],[1,0.25],[1,0.5],[1,0.75],[1,1],[0.75,1],[0.5,1],[0.25,1],[0,1],[0,0.75],[0,0.5],[0,0.25]];outlineConnect=0;gradientColor=none;html=1;whiteSpace=wrap;fontSize=12;fontStyle=0;container=1;pointerEvents=0;collapsible=0;recursiveResize=0;shape=mxgraph.aws4.group;grIcon=mxgraph.aws4.group_security_group;grStroke=0;strokeColor=#7AA116;fillColor=#F2F6E8;verticalAlign=top;align=left;spacingLeft=30;fontColor=#248814;dashed=0;" parent="vpc" vertex="1">
          <mxGeometry x="50" y="50" width="500" height="200" as="geometry" />
        </mxCell>
        
        <!-- Internet Gateway -->
        <mxCell id="igw" value="Internet Gateway" style="sketch=0;points=[[0,0,0],[0.25,0,0],[0.5,0,0],[0.75,0,0],[1,0,0],[0,1,0],[0.25,1,0],[0.5,1,0],[0.75,1,0],[1,1,0],[0,0.25,0],[0,0.5,0],[0,0.75,0],[1,0.25,0],[1,0.5,0],[1,0.75,0],[0,1.256,0],[0.25,1.256,0],[0.5,1.256,0],[0.75,1.256,0],[1,1.256,0]];outlineConnect=0;fontColor=#232F3E;fillColor=#8C4FFF;strokeColor=#ffffff;dashed=0;verticalLabelPosition=bottom;verticalAlign=top;align=center;html=1;fontSize=12;fontStyle=0;aspect=fixed;shape=mxgraph.aws4.resourceIcon;resIcon=mxgraph.aws4.internet_gateway;" parent="public-subnet" vertex="1">
          <mxGeometry x="60" y="60" width="78" height="78" as="geometry" />
        </mxCell>
        
        <!-- NAT Gateway -->
        <mxCell id="nat" value="NAT Gateway" style="sketch=0;points=[[0,0,0],[0.25,0,0],[0.5,0,0],[0.75,0,0],[1,0,0],[0,1,0],[0.25,1,0],[0.5,1,0],[0.75,1,0],[1,1,0],[0,0.25,0],[0,0.5,0],[0,0.75,0],[1,0.25,0],[1,0.5,0],[1,0.75,0],[0,1.256,0],[0.25,1.256,0],[0.5,1.256,0],[0.75,1.256,0],[1,1.256,0]];outlineConnect=0;fontColor=#232F3E;fillColor=#8C4FFF;strokeColor=#ffffff;dashed=0;verticalLabelPosition=bottom;verticalAlign=top;align=center;html=1;fontSize=12;fontStyle=0;aspect=fixed;shape=mxgraph.aws4.resourceIcon;resIcon=mxgraph.aws4.nat_gateway;" parent="public-subnet" vertex="1">
          <mxGeometry x="260" y="60" width="78" height="78" as="geometry" />
        </mxCell>
        
        <!-- Private Subnet -->
        <mxCell id="private-subnet" value="Private Subnet" style="points=[[0,0],[0.25,0],[0.5,0],[0.75,0],[1,0],[1,0.25],[1,0.5],[1,0.75],[1,1],[0.75,1],[0.5,1],[0.25,1],[0,1],[0,0.75],[0,0.5],[0,0.25]];outlineConnect=0;gradientColor=none;html=1;whiteSpace=wrap;fontSize=12;fontStyle=0;container=1;pointerEvents=0;collapsible=0;recursiveResize=0;shape=mxgraph.aws4.group;grIcon=mxgraph.aws4.group_security_group;grStroke=0;strokeColor=#00A4A6;fillColor=#E6F6F7;verticalAlign=top;align=left;spacingLeft=30;fontColor=#147EBA;dashed=0;" parent="vpc" vertex="1">
          <mxGeometry x="50" y="300" width="1300" height="550" as="geometry" />
        </mxCell>
        
        <!-- RAG Chat Lambda -->
        <mxCell id="lambda" value="RAG Chat Lambda" style="sketch=0;points=[[0,0,0],[0.25,0,0],[0.5,0,0],[0.75,0,0],[1,0,0],[0,1,0],[0.25,1,0],[0.5,1,0],[0.75,1,0],[1,1,0],[0,0.25,0],[0,0.5,0],[0,0.75,0],[1,0.25,0],[1,0.5,0],[1,0.75,0],[0,1.256,0],[0.25,1.256,0],[0.5,1.256,0],[0.75,1.256,0],[1,1.256,0]];outlineConnect=0;fontColor=#232F3E;fillColor=#ED7100;strokeColor=#ffffff;dashed=0;verticalLabelPosition=bottom;verticalAlign=top;align=center;html=1;fontSize=12;fontStyle=0;aspect=fixed;shape=mxgraph.aws4.resourceIcon;resIcon=mxgraph.aws4.lambda;" parent="private-subnet" vertex="1">
          <mxGeometry x="80" y="80" width="78" height="78" as="geometry" />
        </mxCell>
        
        <!-- Lambda Badge 2 -->
        <mxCell id="badge-lambda-2" value="2" style="ellipse;whiteSpace=wrap;html=1;fillColor=#FF6B6B;strokeColor=#FFFFFF;fontColor=#FFFFFF;fontSize=14;fontStyle=1" parent="private-subnet" vertex="1">
          <mxGeometry x="70" y="70" width="24" height="24" as="geometry" />
        </mxCell>
        
        <!-- Aurora PostgreSQL -->
        <mxCell id="aurora" value="Aurora PostgreSQL&#xa;(pgvector)" style="sketch=0;points=[[0,0,0],[0.25,0,0],[0.5,0,0],[0.75,0,0],[1,0,0],[0,1,0],[0.25,1,0],[0.5,1,0],[0.75,1,0],[1,1,0],[0,0.25,0],[0,0.5,0],[0,0.75,0],[1,0.25,0],[1,0.5,0],[1,0.75,0],[0,1.256,0],[0.25,1.256,0],[0.5,1.256,0],[0.75,1.256,0],[1,1.256,0]];outlineConnect=0;fontColor=#232F3E;fillColor=#C925D1;strokeColor=#ffffff;dashed=0;verticalLabelPosition=bottom;verticalAlign=top;align=center;html=1;fontSize=12;fontStyle=0;aspect=fixed;shape=mxgraph.aws4.resourceIcon;resIcon=mxgraph.aws4.aurora;" parent="private-subnet" vertex="1">
          <mxGeometry x="80" y="300" width="78" height="78" as="geometry" />
        </mxCell>
        
        <!-- Aurora Badge 3 and 5 -->
        <mxCell id="badge-aurora-3" value="3" style="ellipse;whiteSpace=wrap;html=1;fillColor=#FF6B6B;strokeColor=#FFFFFF;fontColor=#FFFFFF;fontSize=14;fontStyle=1" parent="private-subnet" vertex="1">
          <mxGeometry x="70" y="290" width="24" height="24" as="geometry" />
        </mxCell>
        <mxCell id="badge-aurora-5" value="5" style="ellipse;whiteSpace=wrap;html=1;fillColor=#FF6B6B;strokeColor=#FFFFFF;fontColor=#FFFFFF;fontSize=14;fontStyle=1" parent="private-subnet" vertex="1">
          <mxGeometry x="100" y="290" width="24" height="24" as="geometry" />
        </mxCell>
        <mxCell id="badge-aurora-blue-3" value="3" style="ellipse;whiteSpace=wrap;html=1;fillColor=#4A90E2;strokeColor=#FFFFFF;fontColor=#FFFFFF;fontSize=14;fontStyle=1" parent="private-subnet" vertex="1">
          <mxGeometry x="130" y="290" width="24" height="24" as="geometry" />
        </mxCell>
        
        <!-- VPC Endpoints Group -->
        <mxCell id="vpc-endpoints-group" value="VPC Endpoints" style="fillColor=none;strokeColor=#5A6C86;dashed=1;verticalAlign=top;fontStyle=0;fontColor=#5A6C86;whiteSpace=wrap;html=1;" parent="private-subnet" vertex="1">
          <mxGeometry x="700" y="50" width="550" height="450" as="geometry" />
        </mxCell>
        
        <!-- Bedrock VPC Endpoint -->
        <mxCell id="bedrock-endpoint" value="Bedrock Runtime&#xa;VPC Endpoint" style="sketch=0;points=[[0,0,0],[0.25,0,0],[0.5,0,0],[0.75,0,0],[1,0,0],[0,1,0],[0.25,1,0],[0.5,1,0],[0.75,1,0],[1,1,0],[0,0.25,0],[0,0.5,0],[0,0.75,0],[1,0.25,0],[1,0.5,0],[1,0.75,0],[0,1.256,0],[0.25,1.256,0],[0.5,1.256,0],[0.75,1.256,0],[1,1.256,0]];outlineConnect=0;fontColor=#232F3E;fillColor=#8C4FFF;strokeColor=#ffffff;dashed=0;verticalLabelPosition=bottom;verticalAlign=top;align=center;html=1;fontSize=12;fontStyle=0;aspect=fixed;shape=mxgraph.aws4.resourceIcon;resIcon=mxgraph.aws4.endpoints;" parent="private-subnet" vertex="1">
          <mxGeometry x="760" y="80" width="78" height="78" as="geometry" />
        </mxCell>
        
        <!-- Secrets Manager VPC Endpoint -->
        <mxCell id="secrets-endpoint" value="Secrets Manager&#xa;VPC Endpoint" style="sketch=0;points=[[0,0,0],[0.25,0,0],[0.5,0,0],[0.75,0,0],[1,0,0],[0,1,0],[0.25,1,0],[0.5,1,0],[0.75,1,0],[1,1,0],[0,0.25,0],[0,0.5,0],[0,0.75,0],[1,0.25,0],[1,0.5,0],[1,0.75,0],[0,1.256,0],[0.25,1.256,0],[0.5,1.256,0],[0.75,1.256,0],[1,1.256,0]];outlineConnect=0;fontColor=#232F3E;fillColor=#8C4FFF;strokeColor=#ffffff;dashed=0;verticalLabelPosition=bottom;verticalAlign=top;align=center;html=1;fontSize=12;fontStyle=0;aspect=fixed;shape=mxgraph.aws4.resourceIcon;resIcon=mxgraph.aws4.endpoints;" parent="private-subnet" vertex="1">
          <mxGeometry x="960" y="80" width="78" height="78" as="geometry" />
        </mxCell>
        
        <!-- S3 Gateway Endpoint -->
        <mxCell id="s3-endpoint" value="S3 Gateway&#xa;Endpoint" style="sketch=0;points=[[0,0,0],[0.25,0,0],[0.5,0,0],[0.75,0,0],[1,0,0],[0,1,0],[0.25,1,0],[0.5,1,0],[0.75,1,0],[1,1,0],[0,0.25,0],[0,0.5,0],[0,0.75,0],[1,0.25,0],[1,0.5,0],[1,0.75,0],[0,1.256,0],[0.25,1.256,0],[0.5,1.256,0],[0.75,1.256,0],[1,1.256,0]];outlineConnect=0;fontColor=#232F3E;fillColor=#8C4FFF;strokeColor=#ffffff;dashed=0;verticalLabelPosition=bottom;verticalAlign=top;align=center;html=1;fontSize=12;fontStyle=0;aspect=fixed;shape=mxgraph.aws4.resourceIcon;resIcon=mxgraph.aws4.endpoints;" parent="private-subnet" vertex="1">
          <mxGeometry x="1160" y="80" width="78" height="78" as="geometry" />
        </mxCell>
        
        <!-- Lambda to Aurora connection -->
        <mxCell id="edge-lambda-aurora" value="Store/Query&#xa;Chat History" style="endArrow=classic;html=1;rounded=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="private-subnet" source="lambda" target="aurora" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <!-- Lambda to Bedrock Endpoint connection -->
        <mxCell id="edge-lambda-bedrock-ep" value="Bedrock API" style="endArrow=classic;html=1;rounded=0;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="private-subnet" source="lambda" target="bedrock-endpoint" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <!-- Lambda to Secrets Endpoint connection -->
        <mxCell id="edge-lambda-secrets-ep" value="Get Credentials" style="endArrow=classic;html=1;rounded=0;exitX=1;exitY=0.75;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="private-subnet" source="lambda" target="secrets-endpoint" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="400" y="139" />
              <mxPoint x="400" y="119" />
            </Array>
          </mxGeometry>
        </mxCell>
        
        <!-- Services outside VPC but in AWS Cloud -->
        
        <!-- S3 Bucket -->
        <mxCell id="s3" value="S3 Bucket&#xa;(KB Documents)" style="sketch=0;points=[[0,0,0],[0.25,0,0],[0.5,0,0],[0.75,0,0],[1,0,0],[0,1,0],[0.25,1,0],[0.5,1,0],[0.75,1,0],[1,1,0],[0,0.25,0],[0,0.5,0],[0,0.75,0],[1,0.25,0],[1,0.5,0],[1,0.75,0],[0,1.256,0],[0.25,1.256,0],[0.5,1.256,0],[0.75,1.256,0],[1,1.256,0]];outlineConnect=0;fontColor=#232F3E;fillColor=#7AA116;strokeColor=#ffffff;dashed=0;verticalLabelPosition=bottom;verticalAlign=top;align=center;html=1;fontSize=12;fontStyle=0;aspect=fixed;shape=mxgraph.aws4.resourceIcon;resIcon=mxgraph.aws4.s3;" parent="aws-cloud" vertex="1">
          <mxGeometry x="1800" y="150" width="78" height="78" as="geometry" />
        </mxCell>
        
        <!-- S3 Badge Blue 1 -->
        <mxCell id="badge-s3-blue-1" value="1" style="ellipse;whiteSpace=wrap;html=1;fillColor=#4A90E2;strokeColor=#FFFFFF;fontColor=#FFFFFF;fontSize=14;fontStyle=1" parent="aws-cloud" vertex="1">
          <mxGeometry x="1790" y="140" width="24" height="24" as="geometry" />
        </mxCell>
        
        <!-- Bedrock Knowledge Base -->
        <mxCell id="bedrock-kb" value="Bedrock&#xa;Knowledge Base" style="sketch=0;points=[[0,0,0],[0.25,0,0],[0.5,0,0],[0.75,0,0],[1,0,0],[0,1,0],[0.25,1,0],[0.5,1,0],[0.75,1,0],[1,1,0],[0,0.25,0],[0,0.5,0],[0,0.75,0],[1,0.25,0],[1,0.5,0],[1,0.75,0],[0,1.256,0],[0.25,1.256,0],[0.5,1.256,0],[0.75,1.256,0],[1,1.256,0]];outlineConnect=0;fontColor=#232F3E;fillColor=#01A88D;strokeColor=#ffffff;dashed=0;verticalLabelPosition=bottom;verticalAlign=top;align=center;html=1;fontSize=12;fontStyle=0;aspect=fixed;shape=mxgraph.aws4.resourceIcon;resIcon=mxgraph.aws4.bedrock;" parent="aws-cloud" vertex="1">
          <mxGeometry x="1800" y="400" width="78" height="78" as="geometry" />
        </mxCell>
        
        <!-- Bedrock KB Badge 2 and Blue 2 -->
        <mxCell id="badge-kb-2" value="2" style="ellipse;whiteSpace=wrap;html=1;fillColor=#FF6B6B;strokeColor=#FFFFFF;fontColor=#FFFFFF;fontSize=14;fontStyle=1" parent="aws-cloud" vertex="1">
          <mxGeometry x="1790" y="390" width="24" height="24" as="geometry" />
        </mxCell>
        <mxCell id="badge-kb-blue-2" value="2" style="ellipse;whiteSpace=wrap;html=1;fillColor=#4A90E2;strokeColor=#FFFFFF;fontColor=#FFFFFF;fontSize=14;fontStyle=1" parent="aws-cloud" vertex="1">
          <mxGeometry x="1820" y="390" width="24" height="24" as="geometry" />
        </mxCell>
        
        <!-- Bedrock (Foundation Model) -->
        <mxCell id="bedrock-fm" value="Bedrock&#xa;(Claude/Nova)" style="sketch=0;points=[[0,0,0],[0.25,0,0],[0.5,0,0],[0.75,0,0],[1,0,0],[0,1,0],[0.25,1,0],[0.5,1,0],[0.75,1,0],[1,1,0],[0,0.25,0],[0,0.5,0],[0,0.75,0],[1,0.25,0],[1,0.5,0],[1,0.75,0],[0,1.256,0],[0.25,1.256,0],[0.5,1.256,0],[0.75,1.256,0],[1,1.256,0]];outlineConnect=0;fontColor=#232F3E;fillColor=#01A88D;strokeColor=#ffffff;dashed=0;verticalLabelPosition=bottom;verticalAlign=top;align=center;html=1;fontSize=12;fontStyle=0;aspect=fixed;shape=mxgraph.aws4.resourceIcon;resIcon=mxgraph.aws4.bedrock;" parent="aws-cloud" vertex="1">
          <mxGeometry x="2050" y="400" width="78" height="78" as="geometry" />
        </mxCell>
        
        <!-- Bedrock FM Badge 4 -->
        <mxCell id="badge-fm-4" value="4" style="ellipse;whiteSpace=wrap;html=1;fillColor=#FF6B6B;strokeColor=#FFFFFF;fontColor=#FFFFFF;fontSize=14;fontStyle=1" parent="aws-cloud" vertex="1">
          <mxGeometry x="2040" y="390" width="24" height="24" as="geometry" />
        </mxCell>
        
        <!-- ECR -->
        <mxCell id="ecr" value="ECR&#xa;(Container Registry)" style="sketch=0;points=[[0,0,0],[0.25,0,0],[0.5,0,0],[0.75,0,0],[1,0,0],[0,1,0],[0.25,1,0],[0.5,1,0],[0.75,1,0],[1,1,0],[0,0.25,0],[0,0.5,0],[0,0.75,0],[1,0.25,0],[1,0.5,0],[1,0.75,0],[0,1.256,0],[0.25,1.256,0],[0.5,1.256,0],[0.75,1.256,0],[1,1.256,0]];outlineConnect=0;fontColor=#232F3E;fillColor=#ED7100;strokeColor=#ffffff;dashed=0;verticalLabelPosition=bottom;verticalAlign=top;align=center;html=1;fontSize=12;fontStyle=0;aspect=fixed;shape=mxgraph.aws4.resourceIcon;resIcon=mxgraph.aws4.ecr;" parent="aws-cloud" vertex="1">
          <mxGeometry x="1800" y="700" width="78" height="78" as="geometry" />
        </mxCell>
        
        <!-- Secrets Manager -->
        <mxCell id="secrets-manager" value="Secrets Manager&#xa;(DB Credentials)" style="sketch=0;points=[[0,0,0],[0.25,0,0],[0.5,0,0],[0.75,0,0],[1,0,0],[0,1,0],[0.25,1,0],[0.5,1,0],[0.75,1,0],[1,1,0],[0,0.25,0],[0,0.5,0],[0,0.75,0],[1,0.25,0],[1,0.5,0],[1,0.75,0],[0,1.256,0],[0.25,1.256,0],[0.5,1.256,0],[0.75,1.256,0],[1,1.256,0]];outlineConnect=0;fontColor=#232F3E;fillColor=#DD344C;strokeColor=#ffffff;dashed=0;verticalLabelPosition=bottom;verticalAlign=top;align=center;html=1;fontSize=12;fontStyle=0;aspect=fixed;shape=mxgraph.aws4.resourceIcon;resIcon=mxgraph.aws4.secrets_manager;" parent="aws-cloud" vertex="1">
          <mxGeometry x="2050" y="700" width="78" height="78" as="geometry" />
        </mxCell>
        
        <!-- CloudWatch -->
        <mxCell id="cloudwatch" value="CloudWatch&#xa;(Logs)" style="sketch=0;points=[[0,0,0],[0.25,0,0],[0.5,0,0],[0.75,0,0],[1,0,0],[0,1,0],[0.25,1,0],[0.5,1,0],[0.75,1,0],[1,1,0],[0,0.25,0],[0,0.5,0],[0,0.75,0],[1,0.25,0],[1,0.5,0],[1,0.75,0],[0,1.256,0],[0.25,1.256,0],[0.5,1.256,0],[0.75,1.256,0],[1,1.256,0]];outlineConnect=0;fontColor=#232F3E;fillColor=#E7157B;strokeColor=#ffffff;dashed=0;verticalLabelPosition=bottom;verticalAlign=top;align=center;html=1;fontSize=12;fontStyle=0;aspect=fixed;shape=mxgraph.aws4.resourceIcon;resIcon=mxgraph.aws4.cloudwatch_2;" parent="aws-cloud" vertex="1">
          <mxGeometry x="2300" y="700" width="78" height="78" as="geometry" />
        </mxCell>
        
        <!-- Connections outside VPC -->
        
        <!-- User to Lambda (via API Gateway/direct) -->
        <mxCell id="edge-user-lambda" value="Invoke" style="endArrow=classic;html=1;rounded=0;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="aws-cloud" source="user" target="vpc" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="330" y="530" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        
        <!-- S3 to Bedrock KB -->
        <mxCell id="edge-s3-kb" value="Data Source" style="endArrow=classic;html=1;rounded=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="aws-cloud" source="s3" target="bedrock-kb" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <!-- Bedrock KB to Bedrock FM -->
        <mxCell id="edge-kb-fm" value="Embeddings" style="endArrow=classic;html=1;rounded=0;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="aws-cloud" source="bedrock-kb" target="bedrock-fm" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <!-- Bedrock Endpoint to Bedrock KB -->
        <mxCell id="edge-ep-kb" value="Retrieve" style="endArrow=classic;html=1;rounded=0;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="aws-cloud" source="bedrock-endpoint" target="bedrock-kb" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1760" y="530" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        
        <!-- Secrets Endpoint to Secrets Manager -->
        <mxCell id="edge-secrets-ep-sm" value="Get Secret" style="endArrow=classic;html=1;rounded=0;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="aws-cloud" source="secrets-endpoint" target="secrets-manager" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1960" y="530" as="sourcePoint" />
            <Array as="points">
              <mxPoint x="1750" y="530" />
              <mxPoint x="1750" y="739" />
            </Array>
          </mxGeometry>
        </mxCell>
        
        <!-- ECR to Lambda (dashed for container pull) -->
        <mxCell id="edge-ecr-lambda" value="Pull Image" style="endArrow=classic;html=1;rounded=0;exitX=0;exitY=0.5;exitDx=0;exitDy=0;entryX=1;entryY=0.75;entryDx=0;entryDy=0;dashed=1;dashPattern=8 8;" parent="aws-cloud" source="ecr" target="vpc" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1600" y="739" as="targetPoint" />
            <Array as="points">
              <mxPoint x="1700" y="739" />
              <mxPoint x="1700" y="825" />
            </Array>
          </mxGeometry>
        </mxCell>
        
        <!-- Lambda to CloudWatch (dashed for logs) -->
        <mxCell id="edge-lambda-cw" value="Logs" style="endArrow=classic;html=1;rounded=0;exitX=1;exitY=1;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;dashed=1;dashPattern=8 8;" parent="aws-cloud" source="vpc" target="cloudwatch" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1600" y="600" as="sourcePoint" />
            <Array as="points">
              <mxPoint x="1700" y="1050" />
              <mxPoint x="2200" y="1050" />
              <mxPoint x="2200" y="739" />
            </Array>
          </mxGeometry>
        </mxCell>
        
        <!-- Bedrock KB to Aurora (for vector storage) -->
        <mxCell id="edge-kb-aurora" value="Vector Search" style="endArrow=classic;html=1;rounded=0;exitX=0;exitY=1;exitDx=0;exitDy=0;entryX=1;entryY=0.5;entryDx=0;entryDy=0;" parent="aws-cloud" source="bedrock-kb" target="aurora" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1700" y="500" as="sourcePoint" />
            <mxPoint x="430" y="750" as="targetPoint" />
            <Array as="points">
              <mxPoint x="1700" y="500" />
              <mxPoint x="1700" y="750" />
            </Array>
          </mxGeometry>
        </mxCell>
        
        <!-- GitHub Actions CI/CD Section -->
        <mxCell id="cicd-section" value="CI/CD &amp; Evaluation" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=18;fontStyle=1" parent="aws-cloud" vertex="1">
          <mxGeometry x="80" y="1200" width="300" height="30" as="geometry" />
        </mxCell>
        
        <!-- GitHub Actions -->
        <mxCell id="github" value="GitHub Actions&#xa;(CI/CD)" style="sketch=0;points=[[0,0,0],[0.25,0,0],[0.5,0,0],[0.75,0,0],[1,0,0],[0,1,0],[0.25,1,0],[0.5,1,0],[0.75,1,0],[1,1,0],[0,0.25,0],[0,0.5,0],[0,0.75,0],[1,0.25,0],[1,0.5,0],[1,0.75,0],[0,1.256,0],[0.25,1.256,0],[0.5,1.256,0],[0.75,1.256,0],[1,1.256,0]];outlineConnect=0;fontColor=#232F3E;fillColor=#232F3D;strokeColor=#ffffff;dashed=0;verticalLabelPosition=bottom;verticalAlign=top;align=center;html=1;fontSize=12;fontStyle=0;aspect=fixed;shape=mxgraph.aws4.resourceIcon;resIcon=mxgraph.aws4.codepipeline;" parent="aws-cloud" vertex="1">
          <mxGeometry x="80" y="1280" width="78" height="78" as="geometry" />
        </mxCell>
        
        <!-- IAM Role for GitHub -->
        <mxCell id="iam-role" value="IAM Role&#xa;(OIDC)" style="sketch=0;points=[[0,0,0],[0.25,0,0],[0.5,0,0],[0.75,0,0],[1,0,0],[0,1,0],[0.25,1,0],[0.5,1,0],[0.75,1,0],[1,1,0],[0,0.25,0],[0,0.5,0],[0,0.75,0],[1,0.25,0],[1,0.5,0],[1,0.75,0],[0,1.256,0],[0.25,1.256,0],[0.5,1.256,0],[0.75,1.256,0],[1,1.256,0]];outlineConnect=0;fontColor=#232F3E;fillColor=#DD344C;strokeColor=#ffffff;dashed=0;verticalLabelPosition=bottom;verticalAlign=top;align=center;html=1;fontSize=12;fontStyle=0;aspect=fixed;shape=mxgraph.aws4.resourceIcon;resIcon=mxgraph.aws4.identity_and_access_management;" parent="aws-cloud" vertex="1">
          <mxGeometry x="280" y="1280" width="78" height="78" as="geometry" />
        </mxCell>
        
        <!-- GitHub to IAM -->
        <mxCell id="edge-github-iam" value="OIDC Auth" style="endArrow=classic;html=1;rounded=0;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="aws-cloud" source="github" target="iam-role" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <!-- IAM to Lambda (deploy) -->
        <mxCell id="edge-iam-lambda" value="Deploy" style="endArrow=classic;html=1;rounded=0;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=1;entryDx=0;entryDy=0;dashed=1;dashPattern=8 8;" parent="aws-cloud" source="iam-role" target="vpc" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="500" y="1050" as="targetPoint" />
            <Array as="points">
              <mxPoint x="500" y="1319" />
            </Array>
          </mxGeometry>
        </mxCell>
        
        <!-- S3 Evals Bucket -->
        <mxCell id="s3-evals" value="S3 Bucket&#xa;(Eval Results)" style="sketch=0;points=[[0,0,0],[0.25,0,0],[0.5,0,0],[0.75,0,0],[1,0,0],[0,1,0],[0.25,1,0],[0.5,1,0],[0.75,1,0],[1,1,0],[0,0.25,0],[0,0.5,0],[0,0.75,0],[1,0.25,0],[1,0.5,0],[1,0.75,0],[0,1.256,0],[0.25,1.256,0],[0.5,1.256,0],[0.75,1.256,0],[1,1.256,0]];outlineConnect=0;fontColor=#232F3E;fillColor=#7AA116;strokeColor=#ffffff;dashed=0;verticalLabelPosition=bottom;verticalAlign=top;align=center;html=1;fontSize=12;fontStyle=0;aspect=fixed;shape=mxgraph.aws4.resourceIcon;resIcon=mxgraph.aws4.s3;" parent="aws-cloud" vertex="1">
          <mxGeometry x="480" y="1280" width="78" height="78" as="geometry" />
        </mxCell>
        
        <!-- IAM to S3 Evals -->
        <mxCell id="edge-iam-s3evals" value="Upload Results" style="endArrow=classic;html=1;rounded=0;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="aws-cloud" source="iam-role" target="s3-evals" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <!-- Legend -->
        <mxCell id="legend-title" value="Legend" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=16;fontStyle=1" parent="aws-cloud" vertex="1">
          <mxGeometry x="80" y="1500" width="100" height="30" as="geometry" />
        </mxCell>
        
        <mxCell id="legend-solid" value="" style="endArrow=classic;html=1;rounded=0;" parent="aws-cloud" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="80" y="1560" as="sourcePoint" />
            <mxPoint x="160" y="1560" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="legend-solid-text" value="Data Flow" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=12" parent="aws-cloud" vertex="1">
          <mxGeometry x="170" y="1545" width="100" height="30" as="geometry" />
        </mxCell>
        
        <mxCell id="legend-dashed" value="" style="endArrow=classic;html=1;rounded=0;dashed=1;dashPattern=8 8;" parent="aws-cloud" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="80" y="1600" as="sourcePoint" />
            <mxPoint x="160" y="1600" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="legend-dashed-text" value="Logs / Container Pull / Deploy" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=12" parent="aws-cloud" vertex="1">
          <mxGeometry x="170" y="1585" width="200" height="30" as="geometry" />
        </mxCell>
        
        <mxCell id="legend-badge-red" value="N" style="ellipse;whiteSpace=wrap;html=1;fillColor=#FF6B6B;strokeColor=#FFFFFF;fontColor=#FFFFFF;fontSize=12;fontStyle=1" parent="aws-cloud" vertex="1">
          <mxGeometry x="80" y="1630" width="24" height="24" as="geometry" />
        </mxCell>
        <mxCell id="legend-badge-red-text" value="User Query Flow Step" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=12" parent="aws-cloud" vertex="1">
          <mxGeometry x="110" y="1625" width="150" height="30" as="geometry" />
        </mxCell>
        
        <mxCell id="legend-badge-blue" value="N" style="ellipse;whiteSpace=wrap;html=1;fillColor=#4A90E2;strokeColor=#FFFFFF;fontColor=#FFFFFF;fontSize=12;fontStyle=1" parent="aws-cloud" vertex="1">
          <mxGeometry x="80" y="1665" width="24" height="24" as="geometry" />
        </mxCell>
        <mxCell id="legend-badge-blue-text" value="Document Ingestion Step" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=12" parent="aws-cloud" vertex="1">
          <mxGeometry x="110" y="1660" width="170" height="30" as="geometry" />
        </mxCell>
        
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>

